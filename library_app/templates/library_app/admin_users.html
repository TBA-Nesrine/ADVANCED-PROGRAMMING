{% extends 'library_app/base_admin.html' %}
{% block content %}

<h2>All Users</h2>

<a href="{% url 'admin_add_user' %}">
    <button>Add New User</button>
</a>

<form method="GET" action="{% url 'admin_users' %}">
    <input type="text" name="q" placeholder="Search..." value="{{ request.GET.q }}">
    <button type="submit">Search</button>
</form>

<table>
<tr>
    <th>Reference</th><th>Name</th><th>Email</th>
    <th>Status</th><th>Actions</th>
</tr>

{% for u in users %}
<tr>
    <td>{{ u.reference_id }}</td>
    <td>{{ u.user.username }}</td>
    <td>{{ u.user.email }}</td>
    <td>
        {% if u.active %}
            <span style="color:green;">Active</span>
        {% else %}
            <span style="color:red;">Inactive</span>
        {% endif %}
    </td>
    <td>
        {% if u.active %}
        <form method="POST" action="{% url 'deactivate_user' u.reference_id %}">
            {% csrf_token %}
            <button>Deactivate</button>
        </form>
        {% else %}
        <form method="POST" action="{% url 'activate_user' u.reference_id %}">
            {% csrf_token %}
            <button>Activate</button>
        </form>
        {% endif %}
    </td>
</tr>
{% empty %}
<tr><td colspan="5">No users found.</td></tr>
{% endfor %}
</table>

{% endblock %}

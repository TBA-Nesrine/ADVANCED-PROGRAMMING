{% extends 'library_app/base_user.html' %}
{% block title %}Books | PageTurn Library{% endblock %}

{% block content %}
<h2>Available Books</h2>

<form method="GET" action="{% url 'user_home' %}">
    <input type="text" name="q" placeholder="Search by title/author" value="{{ request.GET.q }}">
    <button type="submit">Search</button>
</form>

<table>
<tr><th>Title</th><th>Author</th><th>Quantity</th><th>Action</th></tr>
{% for book in books %}
<tr>
    <td>{{ book.title }}</td>
    <td>{{ book.author }}</td>
    <td>{{ book.quantity }}</td>
    <td>
        <form method="POST" action="{% url 'user_borrow_book' %}">
            {% csrf_token %}
            <input type="hidden" name="book_id" value="{{ book.id }}">
            <button {% if book.quantity == 0 %}disabled{% endif %}>Borrow</button>
        </form>
    </td>
</tr>
{% empty %}
<tr><td colspan="4">No books available</td></tr>
{% endfor %}
</table>
{% endblock %}
